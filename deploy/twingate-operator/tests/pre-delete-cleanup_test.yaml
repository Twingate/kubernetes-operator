suite: Pre-delete Cleanup
templates:
  - pre-delete-cleanup.yaml
  - charts/kubernetes-access-gateway/templates/*.yaml
set:
  twingateOperator:
    network: "<network slug>"
    apiKey: "<api key>"
    remoteNetworkId: "<remote network id>"
tests:
  - it: should enable pre-delete cleanup job when Kubernetes Access Gateway is enabled
    # Hardcode the chart version and app version to ensure that the snapshot is stable during dependency upgrade
    chart:
      version: "1.0.0"
      appVersion: "1.0.0"
    set:
      kubernetes-access-gateway:
        enabled: true
        twingate:
          network: "<network slug>"
        tls:
          autoGenerated: false
          cert: "<tls cert>"
          key: "<tls key>"
          ca: "<ca cert>"
    asserts:
      - matchSnapshot: {}
